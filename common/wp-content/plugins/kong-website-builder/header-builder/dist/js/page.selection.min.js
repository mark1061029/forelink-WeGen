!function(e){function t(o){if(n[o])return n[o].exports;var s=n[o]={exports:{},id:o,loaded:!1};return e[o].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var n={};t.m=e,t.c=n,t.p="",t(0)}({0:function(e,exports,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t(432),function(e){var t=window.kong_app_header_data.label,o=t.charAt(0).toUpperCase()+t.substr(1),s=e.module("kongPageHeaderApp",["kongPopup"]);s.__config=window.kong_app_header_data,s.controller("PageHeaderController",function(){}),s.config(["$provide","$httpProvider",function(e,t){e.factory("lbHttpInterceptor",["$q","$rootScope",function(e,t){return{request:function(t){return t.headers["X-WP-Nonce"]=s.__config.nonce,t||e.when(t)},responseError:function(n){return void 0!==n.data&&"rest_cookie_invalid_nonce"==n.data.code&&t.$emit("expired_session"),e.reject(n)}}}]),t.interceptors.push("lbHttpInterceptor")}]).config(["$compileProvider",function(e){e.debugInfoEnabled(s.__config.enable_debug)}]),s.component("pageHeaderMetabox",{controller:["$scope","$http","$KongPopup","$rootScope",function(o,i,a,c){var r=this,l={};l[t]="primary";var d={};if(r.items=[],void 0!=n(s.__config))try{d=s.__config.setting,r.items=s.__config.items}catch(e){}r.model=e.merge(l,d),this.syncing=!1,this.sync=function(){this.syncing=!0,i({method:"GET",url:s.__config.api+"/"+t+"s",data:{}}).then(function(t){e.isArray(t.data)&&(r.syncing=!1,r.items=t.data)},function(e){a.show({title:"Try it Later",message:"Cannot sync data now!"}),r.syncing=!1})},c.$on("expired_session",function(){document.location.replace(s.__config.login_url)})}],template:'<input type="hidden" name="kong-page-'+t+'-setting" value="{{$ctrl.model}}" id="kong-page-'+t+'-setting"><div class="kong-smb"><mb-header model="$ctrl.model"></mb-header><div class="kong-smb__body"><div class="kong-smb__listSelection" ng-class="{\'kong-smb__listSelection--syncing\':$ctrl.syncing}"><div class="kong-smb__selection" list-selection ng-model="$ctrl.model[\''+t+"']\" ng-list=\"$ctrl.items\" ng-default=\"[{id:'none', name:'No "+o+"'},{id:'primary', name:'Use Primary "+o+'\', selected:\'selected\'}]"></div><span ng-click="$ctrl.sync()" class="kong-smb__syncBtn dashicons dashicons-update" title="Sync data"></span></div></div><mb-footer selected="$ctrl.model[\''+t+"']\"></mb-footer></div>",bindings:{postId:"@"}}),s.component("mbHeader",{controller:["$timeout","$http","$KongPopup",function(e,n,o){var i=this;this.state="disabled";var a=JSON.stringify(this.model);this.save=function(c){c.preventDefault(),"ready"==i.state&&(i.state="saving",n({method:"POST",url:s.__config.api+"/page-"+t+"-setting",data:{id:s.__config.post_id,settings:JSON.stringify(i.model)}}).then(function(t){i.state="saved",e(function(){a=JSON.stringify(i.model),i.state="disabled"},1e3)},function(e){o.show({title:"Try it Later",message:"Cannot save data now!"}),i.state="ready"}))},i.getState=function(){return"disabled"==i.state&&JSON.stringify(i.model)!==a&&(i.state="ready"),i.state}}],template:'<div class="kong-smb__header"><h6 class="kong-smb__title">'+o+'</h6><button class="kong-smb__saveBtn kong-ui__btn kong-ui__btn--primary" ng-class="\'kong-smb__saveBtn--\'+$ctrl.getState()" ng-click="$ctrl.save($event)"><span>Saved</span><span>Save</span><span></span><span><i class="fa fa-check" aria-hidden="true"></i></span></button></div>',bindings:{model:"<"}}),s.component("mbFooter",{controller:function(){},template:'<div class="kong-smb__footer"><a class="kong-smb__openCrud" href="'+s.__config.list_url+'" target="_blank">'+o+' List</a><a class="kong-smb__editItem" href="'+s.__config.edit_url+"&post_id="+s.__config.post_id+"&"+t+'_id={{$ctrl.selected}}" target="_blank" ng-disabled="$ctrl.selected == \'none\'">Edit</a></div>',bindings:{selected:"<"}}),s.directive("listSelection",["$http",function(e){return{restrict:"A",scope:{ngModel:"=",ngList:"=",ngDefault:"="},link:function(e,t,n){var o=Date.now(),s=jQuery('<select id="uq-'+o+'" style="width: 100%"></select>');t.append(s),s.select2(),e.$watch("ngList",function(){for(var t="",n=[].concat(e.ngDefault).concat(e.ngList),o=[],i=void 0,a=!1,c=0,r=n.length;c<r;c++){var l=n[c],d={id:l.id,name:l.name};e.ngModel==l.id&&(d.selected=!0,a=!0),l.hasOwnProperty("selected")&&l.selected&&(i=c),o[c]=d}!a&&i&&(o[i].selected=!0);for(var p=0,u=o.length;p<u;p++){var g=o[p],_=g.hasOwnProperty("selected")&&g.selected?'selected="selected"':"";t+='<option value="'+g.id+'" '+_+">"+g.name+"</option>"}s.html(t),s.on("change",function(){e.$apply(function(){e.ngModel=s.val()})})},!0)}}}]),e.element(document).ready(function(){e.bootstrap(document.getElementById("kong-page-header"),["kongPageHeaderApp"])})}(window.angular)},432:function(e,exports){"use strict";!function(e){e.module("kongPopup",[]).factory("$KongPopup",function(){return{show:function(t){var n=e.element('<div class="kong-bs__fsPopup"><h6 class="kong-bs__fsPopup__title">'+t.title+'</h6><div class="kong-bs__fsPopup__body">'+t.message+'</div><div class="kong-bs__fsPopup__footer"></div></div><div class="kong-bs__fsPopup__backdrop"></div>'),o=n.find(".kong-bs__fsPopup__footer");if(Array.isArray(t.buttons))t.buttons.forEach(function(t){var n=e.element('<button class="kong-ui__btn"></button>');t.hasOwnProperty("text")?n.html(t.text):n.html("Dismiss"),t.hasOwnProperty("class")?n.addClass(t.class):n.addClass("kong-ui__btn--primary"),n.on("click",function(e){e.preventDefault(),"function"==typeof t.callback&&t.callback(),i()}),o.append(n)});else{var s=e.element('<button class="kong-ui__btn kong-ui__btn--primary">Dismiss</button>');o.append(s),s.on("click",function(e){e.preventDefault(),i()})}e.element("body").append(n),"function"==typeof t.onInit&&t.onInit(n);var i=function(){return n.remove(),document.removeEventListener("keydown",a),"function"==typeof t.onClose&&t.onClose(n),!0},a=function(e){27==e.keyCode&&i()};document.addEventListener("keydown",a)}}})}(window.angular)}});
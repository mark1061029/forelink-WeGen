!function(t){function e(o){if(n[o])return n[o].exports;var s=n[o]={exports:{},id:o,loaded:!1};return t[o].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var n={};e.m=t,e.c=n,e.p="",e(0)}({0:function(t,exports,e){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e(437),function(t){var e=window.kong_app_footer_data.label,o=e.charAt(0).toUpperCase()+e.substr(1),s=t.module("kongPageFooterApp",["kongPopup"]);s.__config=window.kong_app_footer_data,s.controller("PageFooterController",function(){}),s.config(["$provide","$httpProvider",function(t,e){t.factory("lbHttpInterceptor",["$q","$rootScope",function(t,e){return{request:function(e){return e.headers["X-WP-Nonce"]=s.__config.nonce,e||t.when(e)},responseError:function(n){return void 0!==n.data&&"rest_cookie_invalid_nonce"==n.data.code&&e.$emit("expired_session"),t.reject(n)}}}]),e.interceptors.push("lbHttpInterceptor")}]).config(["$compileProvider",function(t){t.debugInfoEnabled(s.__config.enable_debug)}]),s.component("pageFooterMetabox",{controller:["$scope","$http","$KongPopup","$rootScope",function(o,i,a,c){var r=this,l={};l[e]="primary";var d={};if(r.items=[],void 0!=n(s.__config))try{d=s.__config.setting,r.items=s.__config.items}catch(t){}r.model=t.merge(l,d),this.syncing=!1,this.sync=function(){this.syncing=!0,i({method:"GET",url:s.__config.api+"/"+e+"s",data:{}}).then(function(e){t.isArray(e.data)&&(r.syncing=!1,r.items=e.data)},function(t){a.show({title:"Try it Later",message:"Cannot sync data now!"}),r.syncing=!1})},c.$on("expired_session",function(){document.location.replace(s.__config.login_url)})}],template:'<input type="hidden" name="kong-page-'+e+'-setting" value="{{$ctrl.model}}" id="kong-page-'+e+'-setting"><div class="kong-smb"><mb-header model="$ctrl.model"></mb-header><div class="kong-smb__body"><div class="kong-smb__listSelection" ng-class="{\'kong-smb__listSelection--syncing\':$ctrl.syncing}"><div class="kong-smb__selection" list-selection ng-model="$ctrl.model[\''+e+"']\" ng-list=\"$ctrl.items\" ng-default=\"[{id:'none', name:'No "+o+"'},{id:'primary', name:'Use Primary "+o+'\', selected:\'selected\'}]"></div><span ng-click="$ctrl.sync()" class="kong-smb__syncBtn dashicons dashicons-update" title="Sync data"></span></div></div><mb-footer selected="$ctrl.model[\''+e+"']\"></mb-footer></div>",bindings:{postId:"@"}}),s.component("mbHeader",{controller:["$timeout","$http","$KongPopup",function(t,n,o){var i=this;this.state="disabled";var a=JSON.stringify(this.model);this.save=function(c){c.preventDefault(),"ready"==i.state&&(i.state="saving",n({method:"POST",url:s.__config.api+"/page-"+e+"-setting",data:{id:s.__config.post_id,settings:JSON.stringify(i.model)}}).then(function(e){i.state="saved",t(function(){a=JSON.stringify(i.model),i.state="disabled"},1e3)},function(t){o.show({title:"Try it Later",message:"Cannot save data now!"}),i.state="ready"}))},i.getState=function(){return"disabled"==i.state&&JSON.stringify(i.model)!==a&&(i.state="ready"),i.state}}],template:'<div class="kong-smb__header"><h6 class="kong-smb__title">'+o+'</h6><button class="kong-smb__saveBtn kong-ui__btn kong-ui__btn--primary" ng-class="\'kong-smb__saveBtn--\'+$ctrl.getState()" ng-click="$ctrl.save($event)"><span>Saved</span><span>Save</span><span></span><span><i class="fa fa-check" aria-hidden="true"></i></span></button></div>',bindings:{model:"<"}}),s.component("mbFooter",{controller:function(){},template:'<div class="kong-smb__footer"><a class="kong-smb__openCrud" href="'+s.__config.list_url+'" target="_blank">'+o+' List</a><a class="kong-smb__editItem" href="'+s.__config.edit_url+"&post_id="+s.__config.post_id+"&"+e+'_id={{$ctrl.selected}}" target="_blank" ng-disabled="$ctrl.selected == \'none\'">Edit</a></div>',bindings:{selected:"<"}}),s.directive("listSelection",["$http",function(t){return{restrict:"A",scope:{ngModel:"=",ngList:"=",ngDefault:"="},link:function(t,e,n){var o=Date.now(),s=jQuery('<select id="uq-'+o+'" style="width: 100%"></select>');e.append(s),s.select2(),t.$watch("ngList",function(){for(var e="",n=[].concat(t.ngDefault).concat(t.ngList),o=[],i=void 0,a=!1,c=0,r=n.length;c<r;c++){var l=n[c],d={id:l.id,name:l.name};t.ngModel==l.id&&(d.selected=!0,a=!0),l.hasOwnProperty("selected")&&l.selected&&(i=c),o[c]=d}!a&&i&&(o[i].selected=!0);for(var p=0,u=o.length;p<u;p++){var g=o[p],f=g.hasOwnProperty("selected")&&g.selected?'selected="selected"':"";e+='<option value="'+g.id+'" '+f+">"+g.name+"</option>"}s.html(e),s.on("change",function(){t.$apply(function(){t.ngModel=s.val()})})},!0)}}}]),t.element(document).ready(function(){t.bootstrap(document.getElementById("kong-page-footer"),["kongPageFooterApp"])})}(window.angular)},437:function(t,exports){"use strict";!function(t){t.module("kongPopup",[]).factory("$KongPopup",function(){return{show:function(e){var n=t.element('<div class="kong-bs__fsPopup"><h6 class="kong-bs__fsPopup__title">'+e.title+'</h6><div class="kong-bs__fsPopup__body">'+e.message+'</div><div class="kong-bs__fsPopup__footer"></div></div><div class="kong-bs__fsPopup__backdrop"></div>'),o=n.find(".kong-bs__fsPopup__footer");if(Array.isArray(e.buttons))e.buttons.forEach(function(e){var n=t.element('<button class="kong-ui__btn"></button>');e.hasOwnProperty("text")?n.html(e.text):n.html("Dismiss"),e.hasOwnProperty("class")?n.addClass(e.class):n.addClass("kong-ui__btn--primary"),n.on("click",function(t){t.preventDefault(),"function"==typeof e.callback&&e.callback(),i()}),o.append(n)});else{var s=t.element('<button class="kong-ui__btn kong-ui__btn--primary">Dismiss</button>');o.append(s),s.on("click",function(t){t.preventDefault(),i()})}t.element("body").append(n),"function"==typeof e.onInit&&e.onInit(n);var i=function(){return n.remove(),document.removeEventListener("keydown",a),"function"==typeof e.onClose&&e.onClose(n),!0},a=function(t){27==t.keyCode&&i()};document.addEventListener("keydown",a)}}})}(window.angular)}});